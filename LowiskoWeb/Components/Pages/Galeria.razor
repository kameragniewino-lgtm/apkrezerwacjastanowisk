@page "/galeria"
@using LowiskoWeb.Services
@inject BazaDanych Db

<div class="page-galeria">
    <h2>ðŸ“¸ Galeria lowiska</h2>
    <p class="galeria-podtytul">Lowisko Gniewino - Kamera</p>

    <div class="galeria-grid">
        @foreach (var foto in zdjecia)
        {
            <div class="galeria-item" @onclick="() => Pokaz(foto)">
                <img src="@foto.Url" alt="@foto.Opis" loading="lazy" />
                <div class="galeria-opis">@foto.Opis</div>
            </div>
        }
    </div>
</div>

@if (wybraneFoto != null)
{
    <div class="modal-bg" @onclick="() => wybraneFoto = null">
        <div class="galeria-lightbox" @onclick:stopPropagation="true">
            <img src="@wybraneFoto.Url" alt="@wybraneFoto.Opis" />
            <div class="galeria-lightbox-opis">@wybraneFoto.Opis</div>
            <button class="btn-cancel" @onclick="() => wybraneFoto = null">Zamknij</button>
        </div>
    </div>
}

@code {
    private record Foto(string Url, string Opis);
    private Foto? wybraneFoto;
    private List<Foto> zdjecia = [];
    private void Pokaz(Foto f) => wybraneFoto = f;

    protected override void OnInitialized()
    {
        var zBazy = Db.PobierzGalerie();
        if (zBazy.Count > 0)
            zdjecia = zBazy.Select(z => new Foto(z.Url, z.Opis)).ToList();
        else
            zdjecia = Domyslne();
    }

    private static List<Foto> Domyslne() =>
    [
        new("https://images.unsplash.com/photo-1504309092620-4d0ec726efa4?w=600", "Poranek nad lowiskiem"),
        new("https://images.unsplash.com/photo-1440964829947-ca3277bd37f8?w=600", "Stanowiska wedkarskie nad woda"),
        new("https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=600", "Wedkowanie na Kaszubach"),
        new("https://images.unsplash.com/photo-1498654896293-37aacf113fd9?w=600", "Poranny polow"),
        new("https://images.unsplash.com/photo-1501785888041-af3ef285b470?w=600", "Okolica Gniewina"),
        new("https://images.unsplash.com/photo-1583212292454-1fe6229603b7?w=600", "Zachod slonca nad lowiskiem"),
    ];
}
